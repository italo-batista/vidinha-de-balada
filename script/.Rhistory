group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
distinct()
View(tabela_6_gastos_mensal)
View(dados_gastos)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(mes), !is.na(ano))
dados = dados_gastos
tabela_6_gastos_mensal = dados %>%
#  filter(vlrLiquido >= 0) %>%
select(idecadastro, txNomeParlamentar, ano, mes ) %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
distinct()
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(dados %>% filter(nossas_categorias == "Alimentação") %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise(Alimentação = sum(vlrLiquido)))
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(dados %>% filter(nossas_categorias == "Combustíveis") %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise("Combustíveis" = sum(vlrLiquido)))
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(dados %>% filter(nossas_categorias == "Locação de veículos") %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise("Locação de veículos" = sum(vlrLiquido)))
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(dados %>% filter(nossas_categorias == "Passagens aéreas") %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise("Passagens aéreas" = sum(vlrLiquido)))
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(dados %>% filter(nossas_categorias == "Escritório") %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise(Escritório = sum(vlrLiquido)))
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(dados %>% filter(nossas_categorias == "Divulgação de atividade parlamentar") %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise("Divulgação de atividade parlamentar" = sum(vlrLiquido)))
tabela_6_gastos_mensal[is.na(tabela_6_gastos_mensal)] = 0
View(tabela_final_mensal)
tabela_6_gastos_mensal = tabela_6_gastos_mensal %>%
left_join(tabela_final_mensal %>%
group_by(idecadastro, txNomeParlamentar, ano, mes) %>%
summarise("total" = sum(total)))
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos, tabela_final_mensal)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos, tabela_final_mensal)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(mes), !is.na(ano))
cotas = read_csv("../data/final/cota_por_estado.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos, tabela_final_mensal)
tabela_6_gastos_mensal = cria_tabela_6_gastos_mensal(dados_gastos, tabela_final_mensal)
top_estourados = cria_top_estourados(tabela_final_mensal)
View(top_estourados)
sessoes_mensal = cria_sessoes_mensal(votacoes)
empresas = cria_empresas(dados_gastos)
tabela_gastos_empresas = cria_tacria_tabela_gastos_empresas(dados_gastos, empresas)
tabela_gastos_empresas = cria_tabela_gastos_empresas(dados_gastos, empresas)
View(tabela_gastos_empresas)
View(dados_gastos)
View(dados_gastos)
twitter_profiles = ("../data/final/twitter_profiles.csv")
info_deputados = ("../data/final/infodeputados.csv")
twitter_profiles = read_csv("../data/final/twitter_profiles.csv")
info_deputados = read_csv("../data/final/infodeputados.csv")
View(tabela_gastos_empresas)
tabela_gastos_empresas = tabela_gastos_empresas %>%
rbind(tabela_gastos_empresas.na) %>%
group_by(txNomeParlamentar, idecadastro, sgUF,  ano, mes, txtCNPJCPF, txtFornecedor, nossas_categorias) %>%
mutate(vlrLiquido = sum(vlrLiquido))
dados = dados_gastos
tabela_gastos_empresas =  dados %>%
filter(!is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, sgUF,  ano, mes, vlrLiquido, txtCNPJCPF, nossas_categorias) %>%
left_join(empresas)
tabela_gastos_empresas.na =  dados %>%
filter(is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, sgUF,  ano, mes, vlrLiquido, txtFornecedor, nossas_categorias) %>%
left_join(empresas %>% filter(txtCNPJCPF == "00000000000000"))
tabela_gastos_empresas = tabela_gastos_empresas %>%
rbind(tabela_gastos_empresas.na) %>%
group_by(txNomeParlamentar, idecadastro, sgUF,  ano, mes, txtCNPJCPF, txtFornecedor, nossas_categorias) %>%
mutate(vlrLiquido = sum(vlrLiquido))
tabela_gastos_empresas =  dados %>%
filter(!is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, sgUF,  ano, mes, vlrLiquido, txtCNPJCPF, nossas_categorias) %>%
left_join(empresas)
tabela_gastos_empresas.na =  dados %>%
filter(is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, sgUF,  ano, mes, vlrLiquido, txtFornecedor, nossas_categorias) %>%
left_join(empresas %>% filter(txtCNPJCPF == "00000000000000"))
View(tabela_gastos_empresas.na)
tabela_gastos_empresas = tabela_gastos_empresas %>%
rbind(tabela_gastos_empresas.na) %>%
group_by(txNomeParlamentar, idecadastro, sgUF,  ano, mes, txtCNPJCPF, txtFornecedor, nossas_categorias) %>%
mutate(vlrLiquido = sum(vlrLiquido)) %>%
distinct()
tabela_gastos_empresas =  dados %>%
filter(!is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, sgUF,  ano, mes, vlrLiquido, txtCNPJCPF, nossas_categorias) %>%
left_join(empresas)
tabela_gastos_empresas.na =  dados %>%
filter(is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, sgUF,  ano, mes, vlrLiquido, txtFornecedor, nossas_categorias) %>%
left_join(empresas %>% filter(txtCNPJCPF == "00000000000000"))
tabela_gastos_empresas = tabela_gastos_empresas %>%
rbind(tabela_gastos_empresas.na) %>%
group_by(txNomeParlamentar, idecadastro, sgUF,  ano, mes, txtCNPJCPF, txtFornecedor, nossas_categorias, vlrLiquido) %>%
mutate(vlrLiquido = sum(vlrLiquido)) %>%
distinct()
tabela_gastos_empresas = tabela_gastos_empresas %>%
rbind(tabela_gastos_empresas.na) %>%
group_by(txNomeParlamentar, idecadastro, sgUF,  ano, mes, txtCNPJCPF, txtFornecedor, nossas_categorias) %>%
summarise(total = sum(vlrLiquido))
View(twitter_profiles)
names(twitter_profiles)[3] = c("idecadastro")
View(info_deputados)
names(info_deputados)[1] = c("idecadastro")
tabela_info_pessoais = dados %>% select(idecadastro, txNomeParlamentar) %>%
left_join(info_deputados %>% select(idecadastro, urlFoto, fone, email)) %>%
left_join(twitter_profiles %>% select(idecadastro, twitter_profile))
View(tabela_info_pessoais)
tabela_info_pessoais = dados %>% select(idecadastro, txNomeParlamentar) %>% distinct() %>%
left_join(info_deputados %>% select(idecadastro, urlFoto, fone, email)) %>%
left_join(twitter_profiles %>% select(idecadastro, twitter_profile))
ultimos_partidos = tabela_final_votacoes %>%
arrange(anov, mesv)
View(ultimos_partidos)
ultimos_partidos = tabela_final_votacoes %>%
arrange(id_dep, -anov, -mesv)
ultimos_partidos = tabela_final_votacoes %>%
arrange(id_dep, -anov, -mesv) %>%
mutate(partido = first(partido)) %>%
group_by(id_dep, nome, partido) %>%
distinct()
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
mutate(partido = first(partido)) %>%
group_by(id_dep, nome, partido) %>%
distinct()
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv)
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
mutate(partido = first(partido)) %>%
group_by(id_dep, nome, partido) %>%
distinct()
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep, nome) %>%
mutate(partido = first(partido)) %>%
distinct()
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep, nome) %>%
summarise(partido = first(partido)) %>%
distinct()
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep, nome) %>%
summarise(partido = first(partido)) %>%
tabela_info_pessoais = dados %>% select(idecadastro, txNomeParlamentar) %>% distinct() %>%
left_join(info_deputados %>% select(idecadastro, urlFoto, fone, email)) %>%
left_join(twitter_profiles %>% select(idecadastro, twitter_profile))
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep, nome) %>%
summarise(partido = first(partido))
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv)
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep, nome) %>%
summarise(partido = first(partido))
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep) %>%
summarise(partido = first(partido))
View(dados)
names(ultimos_partidos)[1] = c("idecadastro")
tabela_info_pessoais = dados %>% select(idecadastro, txNomeParlamentar, sfUF) %>% distinct() %>%
left_join(ultimos_partidos) %>%
left_join(info_deputados %>% select(idecadastro, urlFoto, fone, email)) %>%
left_join(twitter_profiles %>% select(idecadastro, twitter_profile))
tabela_info_pessoais = dados %>% select(idecadastro, txNomeParlamentar, sgUF) %>% distinct() %>%
left_join(ultimos_partidos) %>%
left_join(info_deputados %>% select(idecadastro, urlFoto, fone, email)) %>%
left_join(twitter_profiles %>% select(idecadastro, twitter_profile))
ultimos_partidos = tabela_final_votacoes %>%
ungroup() %>%
arrange(id_dep, -anov, -mesv) %>%
group_by(id_dep, nome) %>%
summarise(partido = first(partido))
View(dados)
View(ultimos_partidos)
ultimos_partidos = dados %>%
ungroup() %>%
arrange(idecadastro, -ano, -mes) %>%
group_by(idecadastro, txNomeParlamentar) %>%
summarise(sgPartido = first(sgPartido))
tabela_info_pessoais = dados %>% select(idecadastro, txNomeParlamentar, sgUF) %>% distinct() %>%
left_join(ultimos_partidos) %>%
left_join(info_deputados %>% select(idecadastro, urlFoto, fone, email)) %>%
left_join(twitter_profiles %>% select(idecadastro, twitter_profile))
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(mes), !is.na(ano))
cotas = read_csv("../data/final/cota_por_estado.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
twitter_profiles = read_csv("../data/final/twitter_profiles.csv")
info_deputados = read_csv("../data/final/infodeputados.csv")
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(mes), !is.na(ano))
cotas = read_csv("../data/final/cota_por_estado.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
twitter_profiles = read_csv("../data/final/twitter_profiles.csv")
info_deputados = read_csv("../data/final/infodeputados.csv")
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(mes), !is.na(ano))
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
tabela_6_gastos_mensal = cria_tabela_6_gastos_mensal(dados_gastos, tabela_final_mensal)
sessoes_mensal = cria_sessoes_mensal(votacoes)
empresas = cria_empresas(dados_gastos)
tabela_gastos_empresas = cria_tabela_gastos_empresas(dados_gastos, empresas)
tabela_info_pessoais = cria_tabela_info_pessoais(info_deputados, twitter_profiles, dados_gastos)
View(tabela_info_pessoais)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
View(tabela_final_votacoes)
View(tabela_6_gastos_mensal)
View(tabela_gastos_empresas)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
tabela_gastos_empresas = cria_tabela_gastos_empresas(dados_gastos, empresas)
View(tabela_gastos_empresas)
tabela_gastos_empresas =  dados %>%
filter(!is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro,ano, mes, vlrLiquido, txtCNPJCPF, nossas_categorias) %>%
left_join(empresas)
tabela_gastos_empresas.na =  dados %>%
filter(is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, ano, mes, vlrLiquido, txtFornecedor, nossas_categorias) %>%
left_join(empresas %>% filter(txtCNPJCPF == "00000000000000"))
dados = dados_gastos
tabela_gastos_empresas =  dados %>%
filter(!is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro,ano, mes, vlrLiquido, txtCNPJCPF, nossas_categorias) %>%
left_join(empresas)
tabela_gastos_empresas.na =  dados %>%
filter(is.na(txtCNPJCPF)) %>%
select(txNomeParlamentar, idecadastro, ano, mes, vlrLiquido, txtFornecedor, nossas_categorias) %>%
left_join(empresas %>% filter(txtCNPJCPF == "00000000000000"))
tabela_gastos_empresas = tabela_gastos_empresas %>%
rbind(tabela_gastos_empresas.na) %>%
group_by(txNomeParlamentar, idecadastro, ano, mes, txtCNPJCPF, txtFornecedor, nossas_categorias) %>%
summarise(total = sum(vlrLiquido))
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
tabela_final_gastos = cria_tabela_final_gastos(dados_gastos)
View(tabela_6_gastos_mensal)
mediana_gastos = tabela_6_gastos_mensal %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
mutate("Alimentação" = median("Alimentação"),
"Combustíveis" = median("Combustíveis"),
"Locação de veículos" = median("Locação de veículos"),
"Passagens aéreas" = median("Passagens aéreas"),
"Escritório" = median("Escritório"),
"Divulgação de atividade parlamentar" = median("Divulgação de atividade parlamentar"))
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
mutate("Alimentação" = median("Alimentação"),
"Combustíveis" = median("Combustíveis"),
"Locação de veículos" = median("Locação de veículos"),
"Passagens aéreas" = median("Passagens aéreas"),
"Escritório" = median("Escritório"),
"Divulgação de atividade parlamentar" = median("Divulgação de atividade parlamentar"))
View(mediana_gastos)
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
mutate("Alimentação" = median(`Alimentação`))
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
mutate("Alimentação" = median(`Alimentação`),
"Combustíveis" = median(`Combustíveis`),
"Locação de veículos" = median(`Locação de veículos`),
"Passagens aéreas" = median(`Passagens aéreas`),
"Escritório" = median(`Escritório`),
"Divulgação de atividade parlamentar" = median(`Divulgação de atividade parlamentar`))
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
mutate("Alimentação" = median(`Alimentação`),
"Combustíveis" = median(`Combustíveis`),
"Locação de veículos" = median(`Locação de veículos`),
"Passagens aéreas" = median(`Passagens aéreas`),
"Escritório" = median(`Escritório`),
"Divulgação de atividade parlamentar" = median(`Divulgação de atividade parlamentar`)) %>%
unique()
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
mutate("Alimentação" = median(`Alimentação`),
"Combustíveis" = median(`Combustíveis`),
"Locação de veículos" = median(`Locação de veículos`),
"Passagens aéreas" = median(`Passagens aéreas`),
"Escritório" = median(`Escritório`),
"Divulgação de atividade parlamentar" = median(`Divulgação de atividade parlamentar`)) %>%
distinct()
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
summarise("Alimentação" = median(`Alimentação`),
"Combustíveis" = median(`Combustíveis`),
"Locação de veículos" = median(`Locação de veículos`),
"Passagens aéreas" = median(`Passagens aéreas`),
"Escritório" = median(`Escritório`),
"Divulgação de atividade parlamentar" = median(`Divulgação de atividade parlamentar`))
??gather
library(tidyr)
reverse = tabela_6_gastos_mensal %>%
gather("categoria", "valor", 5:10)
View(reverse)
reverse = tabela_6_gastos_mensal %>% select(-total) %>%
gather("categoria", "valor", 5:10)
View(mediana_gastos)
mediana_gastos = tabela_6_gastos_mensal %>%
ungroup() %>%
select(-idecadastro, -txNomeParlamentar, -total) %>%
group_by(ano, mes) %>%
summarise("Alimentação" = median(`Alimentação`),
"Combustíveis" = median(`Combustíveis`),
"Locação de veículos" = median(`Locação de veículos`),
"Passagens aéreas" = median(`Passagens aéreas`),
"Escritório" = median(`Escritório`),
"Divulgação de atividade parlamentar" = median(`Divulgação de atividade parlamentar`)) %>%
gather("categoria", "valor", 3:8)
reverse = tabela_6_gastos_mensal %>% select(-total) %>%
gather("categoria", "valor", 5:10) %>%
group_by(ano, mes, categoria) %>%
mutate("mediana" = median(valor))
ganhadores_selos = tabela_6_gastos_mensal %>% select(-total) %>%
gather("categoria", "valor", 5:10) %>%
group_by(ano, mes, categoria) %>%
mutate("mediana" = median(valor)) %>%
filter(valor > mediana)
View(ganhadores_selos)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(mes), !is.na(ano))
cotas = read_csv("../data/final/cota_por_estado.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
twitter_profiles = read_csv("../data/final/twitter_profiles.csv")
info_deputados = read_csv("../data/final/infodeputados.csv")
tabela_final_gastos = cria_tabela_final_gastos(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_gastos)
tabela_6_gastos_mensal = cria_tabela_6_gastos_mensal(dados_gastos, tabela_final_gastos)
sessoes_mensal = cria_sessoes_mensal(votacoes)
empresas = cria_empresas(dados_gastos)
tabela_gastos_empresas = cria_tabela_gastos_empresas(dados_gastos, empresas)
View(tabela_gastos_empresas)
View(tabela_6_gastos_mensal)
View(tabela_gastos_empresas)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(numMes), !is.na(numAno))
cotas = read_csv("../data/final/cota_por_estado.csv")
#votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
#emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip", "siconv_emenda.csv")
twitter_profiles = read_csv("../data/final/twitter_profiles.csv")
info_deputados = read_csv("../data/final/infodeputados.csv")
# esse csv não gera nenhuma tabela no bd
# tabela_final_gastos = cria_tabela_final_gastos(dados_gastos)
# write.csv(tabela_final_gastos, "tabela_final_gastos.csv", row.names = F)
# tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
# write.csv(tabela_final_categoria, "tabela_final_categoria.csv", row.names = F)
# tabela_gastos_presenca = cria_tabela_gastos_presenca(tabela_final_votacoes, tabela_final_gastos)
# write.csv(tabela_gastos_presenca, "tabela_gastos_presenca.csv", row.names = F)
# esse csv não gera nenhuma tabela no bd
# tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_gastos)
# write.csv(tabela_gasto_total_anos, "tabela_gasto_total_anos.csv", row.names = F)
# tabela_6_gastos = cria_tabela_6_gastos(dados_gastos)
# write.csv(tabela_6_gastos, "tabela_6_gastos.csv", row.names = F)
# esse csv não gera nenhuma tabela no bd
# tabela_6_gastos_mensal = cria_tabela_6_gastos_mensal(dados_gastos, tabela_final_gastos)
# write.csv(tabela_6_gastos_mensal, "tabela_6_gastos_mensal.csv", row.names = F)
# top_estourados = cria_top_estourados(tabela_final_gastos)
# write.csv(top_estourados, "top_estourados.csv", row.names = F)
# for(i in 1:NROW(cotas)){
#   temp = cria_top_estourados_estado(cotas$sgUF[i], tabela_final_gastos)
#
#   uf = cotas$sgUF[i]
#   write.csv(temp, paste("top_10_estourados_", uf, ".csv", sep=""), row.names = F)
# }
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
write.csv(tabela_final_votacoes, "tabela_final_votacoes.csv", row.names = F)
sessoes_mensal = cria_sessoes_mensal(votacoes)
write.csv(sessoes_mensal, "sessoes_mensal.csv", row.names = F)
empresas = cria_empresas(dados_gastos)
write.csv(empresas, "empresas.csv", row.names = F)
tabela_gastos_empresas = cria_tabela_gastos_empresas(dados_gastos, empresas)
write.csv(tabela_gastos_empresas, "tabela_gastos_empresas.csv", row.names = F)
tabela_info_deputados = cria_tabela_info_deputados(info_deputados, twitter_profiles, dados_gastos)
write.csv(tabela_info_deputados, "tabela_info_deputados.csv", row.names = F)
rm(tabela_info_deputados, tabela_gastos_empresas, empresas, sessoes_mensal,tabela_final_votacoes)
#rm(tabela_6_gastos_mensal, tabela_final_gastos, tabela_gasto_total_anos, tabela_info_pessoais,twitter_profiles, dados_gastos, info_deputados, votacoes)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017() %>% filter(!is.na(numMes), !is.na(numAno))
cotas = read_csv("../data/final/cota_por_estado.csv")
#votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
#emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip", "siconv_emenda.csv")
twitter_profiles = read_csv("../data/final/twitter_profiles.csv")
info_deputados = read_csv("../data/final/infodeputados.csv")
# esse csv não gera nenhuma tabela no bd
# tabela_final_gastos = cria_tabela_final_gastos(dados_gastos)
# write.csv(tabela_final_gastos, "tabela_final_gastos.csv", row.names = F)
# tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
# write.csv(tabela_final_categoria, "tabela_final_categoria.csv", row.names = F)
# tabela_gastos_presenca = cria_tabela_gastos_presenca(tabela_final_votacoes, tabela_final_gastos)
# write.csv(tabela_gastos_presenca, "tabela_gastos_presenca.csv", row.names = F)
# esse csv não gera nenhuma tabela no bd
# tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_gastos)
# write.csv(tabela_gasto_total_anos, "tabela_gasto_total_anos.csv", row.names = F)
# tabela_6_gastos = cria_tabela_6_gastos(dados_gastos)
# write.csv(tabela_6_gastos, "tabela_6_gastos.csv", row.names = F)
# esse csv não gera nenhuma tabela no bd
# tabela_6_gastos_mensal = cria_tabela_6_gastos_mensal(dados_gastos, tabela_final_gastos)
# write.csv(tabela_6_gastos_mensal, "tabela_6_gastos_mensal.csv", row.names = F)
# top_estourados = cria_top_estourados(tabela_final_gastos)
# write.csv(top_estourados, "top_estourados.csv", row.names = F)
# for(i in 1:NROW(cotas)){
#   temp = cria_top_estourados_estado(cotas$sgUF[i], tabela_final_gastos)
#
#   uf = cotas$sgUF[i]
#   write.csv(temp, paste("top_10_estourados_", uf, ".csv", sep=""), row.names = F)
# }
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
write.csv(tabela_final_votacoes, "tabela_final_votacoes.csv", row.names = F)
sessoes_mensal = cria_sessoes_mensal(votacoes)
write.csv(sessoes_mensal, "sessoes_mensal.csv", row.names = F)
empresas = cria_empresas(dados_gastos)
write.csv(empresas, "empresas.csv", row.names = F)
tabela_gastos_empresas = cria_tabela_gastos_empresas(dados_gastos, empresas)
write.csv(tabela_gastos_empresas, "tabela_gastos_empresas.csv", row.names = F)
tabela_info_deputados = cria_tabela_info_deputados(info_deputados, twitter_profiles, dados_gastos)
write.csv(tabela_info_deputados, "tabela_info_deputados.csv", row.names = F)
rm(tabela_info_deputados, tabela_gastos_empresas, empresas, sessoes_mensal,tabela_final_votacoes)
#rm(tabela_6_gastos_mensal, tabela_final_gastos, tabela_gasto_total_anos, tabela_info_pessoais,twitter_profiles, dados_gastos, info_deputados, votacoes)
